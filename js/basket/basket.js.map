{"version":3,"file":"basket.js","sources":["../../../src/js/pages/basket/markup-cards-basket.js","../../../src/js/pages/basket/get-local-storage-data.js","../../../src/js/basket.js"],"sourcesContent":["export function markupCardsSuccess(arrData) {\n  return arrData.map((obj, i) => {\n    const {\n      id,\n      discount,\n      price,\n      oldPrice,\n      title,\n      img: { png, webp },\n    } = obj;\n\n    // Return HTML markup for cards\n    return `\n      <li class=\"basket-main__list-item\" data-id=\"${id}\">\n          <picture class=\"basket-main__list-picture\">\n            <source\n              srcset=\"${webp}\"\n              type=\"image/webp\" />\n            <img\n              class=\"basket-main__list-img\"\n              width=\"83\"\n              height=\"104\"\n              src=\"${png}\"\n              alt=\"#\" />\n          </picture>\n\n          <div class=\"basket-main__list-info\">\n            <h3 class=\"basket-main__list-title\">${title}</h3>\n\n            <div class=\"basket-main__list-price-piece\">\n              <p class=\"basket-main__list-price-piece_new\">${price} <span>₴</span></p>\n              ${discount ? `<p class=\"basket-main__list-price-piece_old js-old-price\" data-old-price=\"${oldPrice}\">${oldPrice} <span>₴</span></p>` : ''}\n            </div>\n\n            <div class=\"basket-main__list-amount-box\">\n              <button class=\"basket-main__list-btn js-basket-btn-decrement\">\n                <svg\n                  class=\"basket-main__list-btn-icon\"\n                  width=\"9\"\n                  height=\"4\">\n                  <use xlink:href=\"#small-arrow-left\"></use>\n                </svg>\n              </button>\n              <span class=\"basket-main__list-amount js-basket-amount\">1</span>\n              <button class=\"basket-main__list-btn js-basket-btn-increment\">\n                <svg\n                  class=\"basket-main__list-btn-icon\"\n                  width=\"9\"\n                  height=\"4\">\n                  <use xlink:href=\"#small-arrow-righ\"></use>\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          <div class=\"basket-main__list-price-box list-price\">\n            <div class=\"list-price__icon-box\">\n              <svg\n                width=\"18\"\n                height=\"18\"\n                class=\"list-price__icon list-price__icon_remove js-remove-card\">\n                <use class=\"js-remove-card\" xlink:href=\"#remove-basket\"></use>\n              </svg>\n              <svg\n                width=\"16\"\n                height=\"14\"\n                class=\"list-price__icon list-price__icon_favorite\">\n                <use xlink:href=\"#icon-heart\"></use>\n              </svg>\n            </div>\n            <p class=\"list-price__price js-current-price\" \n            data-price=\"${price}\">\n            ${price}<span> ₴</span>\n            </p>\n          </div>\n        </li>`;\n  });\n}\n\nexport function markupCardsError() {\n  return `\n      <li\n        class=\"basket-main__list-item_empty-basket list-item__empty-basket js-empty-basket-item\">\n        <h3 class=\"list-item__empty-basket-title\">\n          Ваш кошик порожній - додайте товари, щоб він не сумував.\n        </h3>\n        <img\n          class=\"list-item__empty-basket-img\"\n          width=\"500\"\n          height=\"500\"\n          src=\"https://firebasestorage.googleapis.com/v0/b/flowers-4b1a5.appspot.com/o/pages%2F404%2Fempty-shopping-cart.webp?alt=media&token=3c262b31-1194-4d5e-9cc7-4c1f827f99a0\"\n          alt=\"#\" />\n      </li>`;\n}\n","import { KEY_BASKET } from '../../utils/constants';\nimport { markupCardsSuccess, markupCardsError } from './markup-cards-basket';\nimport { updateLocalStorageCounter } from '../../utils/update-local-storage-counter';\n// import { calculateOrde } from './order-handler';\n\nexport function getLocalStorageData() {\n  const cardList = document.querySelector('.js-basket-card-list');\n  const titleShoppingList = document.querySelector('.js-title-shopping-list');\n\n  const orderTotalPrice = document.querySelector('.js-order-total-price');\n  const goodsPrice = document.querySelector('.js-goods-price');\n  const discount = document.querySelector('.js-discount-price');\n\n  // console.log(orderTotalPrice.textContent);\n  // ---refs--\n  let basketArr = JSON.parse(localStorage.getItem(KEY_BASKET)) ?? [];\n\n  // ---createMarkup---\n  function createMarkup(arrData) {\n    if (arrData.length) {\n      cardList.innerHTML = markupCardsSuccess(arrData).join('');\n      titleShoppingList.style.display = 'flex';\n    } else {\n      cardList.innerHTML = markupCardsError();\n      titleShoppingList.style.display = 'none';\n    }\n  }\n  createMarkup(basketArr);\n\n  // ---handlerLocalStorageData---\n  cardList.addEventListener('click', handlerLocalStorageData);\n\n  function handlerLocalStorageData({ target, type }) {\n    if (target.classList.contains('js-remove-card')) {\n      removeTargetCard(target);\n    }\n\n    if (target.closest('.js-basket-btn-increment')) {\n      incrementQuantity(target);\n    } else if (target.closest('.js-basket-btn-decrement')) {\n      decrementQuantity(target);\n    }\n  }\n\n  // ------calculateOrde--\n\n  function calculateOrde(arrData) {\n    let priceWithoutDiscount = 0;\n    let discountPrice = 0;\n\n    arrData.forEach(item => {\n      priceWithoutDiscount += item.oldPrice;\n      discountPrice += item.price;\n    });\n\n    orderTotalPrice.textContent = `${discountPrice} ₴`;\n    goodsPrice.textContent = `${priceWithoutDiscount} ₴`;\n    discount.textContent = `${priceWithoutDiscount - discountPrice} ₴`;\n    // console.log(orderTotalPrice.textContent);\n  }\n\n  calculateOrde(basketArr);\n\n  let orderTotal = parseInt(orderTotalPrice.textContent);\n  // let orderDiscount = parseInt(discount.textContent);\n  let priceOfGoods = parseInt(goodsPrice.textContent);\n\n  // ---incrementQuantity---\n  function incrementQuantity(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    let amountEl = targetCard.querySelector('.js-basket-amount');\n    let currentPriceEl = targetCard.querySelector('.js-current-price');\n    let oldPrice = targetCard.querySelector('.js-old-price')\n      ? targetCard.querySelector('.js-old-price').dataset.oldPrice\n      : +currentPriceEl.dataset.price;\n\n    console.log(oldPrice);\n\n    // ---refs--\n    let quantity = +amountEl.textContent;\n\n    const currentPrice = +currentPriceEl.dataset.price;\n\n    // console.log(currentPrice);\n\n    if (quantity >= 10) return;\n\n    amountEl.textContent = quantity += 1;\n    currentPriceEl.textContent = `${currentPrice * quantity} ₴`;\n\n    orderTotalPrice.textContent = `${(orderTotal += currentPrice)} ₴`;\n\n    goodsPrice.textContent = `${(priceOfGoods += Number(oldPrice))} ₴`;\n  }\n\n  // ---decrementQuantity---\n  function decrementQuantity(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    let amountEl = targetCard.querySelector('.js-basket-amount');\n    let currentPriceEl = targetCard.querySelector('.js-current-price');\n    let oldPrice = targetCard.querySelector('.js-old-price')\n      ? targetCard.querySelector('.js-old-price').dataset.oldPrice\n      : +currentPriceEl.dataset.price;\n    // ---refs--\n    let quantity = +amountEl.textContent;\n    const currentPrice = +currentPriceEl.dataset.price;\n\n    if (quantity <= 1) return;\n\n    amountEl.textContent = quantity -= 1;\n    currentPriceEl.textContent = `${currentPrice * quantity} ₴`;\n\n    orderTotalPrice.textContent = `${(orderTotal -= currentPrice)} ₴`;\n    goodsPrice.textContent = `${(priceOfGoods -= Number(oldPrice))} ₴`;\n  }\n\n  // --removeTargetCard---\n  function removeTargetCard(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    const cardId = targetCard.dataset.id;\n\n    targetCard.remove();\n\n    basketArr = basketArr.filter(({ id }) => {\n      return id !== cardId;\n    });\n\n    localStorage.setItem(KEY_BASKET, JSON.stringify(basketArr));\n\n    updateLocalStorageCounter();\n    calculateOrde(basketArr);\n\n    updateStorage(basketArr);\n\n    if (!basketArr.length) {\n      cardList.innerHTML = markupCardsError();\n      titleShoppingList.style.display = 'none';\n    }\n  }\n\n  window.addEventListener('storage', updateStorage);\n\n  function updateStorage() {\n    basketArr = JSON.parse(localStorage.getItem(KEY_BASKET)) ?? [];\n    updateLocalStorageCounter();\n    createMarkup(basketArr);\n    calculateOrde(basketArr);\n  }\n}\n","import { header } from './partials/header';\nimport { mobMenu } from './partials/mob-menu';\nimport { createAccordionFaq } from './partials/accordion';\nimport { getLocalStorageData } from './pages/basket/get-local-storage-data';\nimport { updateLocalStorageCounter } from './utils/update-local-storage-counter';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  header();\n  mobMenu();\n  createAccordionFaq();\n  getLocalStorageData();\n  updateLocalStorageCounter();\n});\n"],"names":["markupCardsSuccess","arrData","obj","i","id","discount","price","oldPrice","title","png","webp","markupCardsError","getLocalStorageData","cardList","titleShoppingList","orderTotalPrice","goodsPrice","basketArr","KEY_BASKET","createMarkup","handlerLocalStorageData","target","type","removeTargetCard","incrementQuantity","decrementQuantity","calculateOrde","priceWithoutDiscount","discountPrice","item","orderTotal","priceOfGoods","targetCard","amountEl","currentPriceEl","quantity","currentPrice","cardId","updateLocalStorageCounter","updateStorage","header","mobMenu","createAccordionFaq"],"mappings":"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"}