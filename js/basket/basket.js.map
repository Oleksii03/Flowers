{"version":3,"file":"basket.js","sources":["../../../src/js/pages/basket/markup-cards-basket.js","../../../src/js/pages/basket/get-local-storage-data.js","../../../src/js/pages/basket/create-markup-swiper.js","../../../src/js/basket.js"],"sourcesContent":["export function markupCardsSuccess(arrData) {\n  return arrData.map((obj, i) => {\n    const {\n      id,\n      discount,\n      price,\n      oldPrice,\n      title,\n      img: { png, webp },\n    } = obj;\n\n    // Return HTML markup for cards\n    return `\n      <li class=\"basket-main__list-item\" data-id=\"${id}\">\n          <picture class=\"basket-main__list-picture\">\n            <source\n              srcset=\"${webp}\"\n              type=\"image/webp\" />\n            <img\n              class=\"basket-main__list-img\"\n              width=\"83\"\n              height=\"104\"\n              src=\"${png}\"\n              alt=\"#\" />\n          </picture>\n\n          <div class=\"basket-main__list-info\">\n            <h3 class=\"basket-main__list-title\">${title}</h3>\n\n            <div class=\"basket-main__list-price-piece\">\n              <p class=\"basket-main__list-price-piece_new\">${price} <span>₴</span></p>\n              ${discount ? `<p class=\"basket-main__list-price-piece_old js-old-price\" data-old-price=\"${oldPrice}\">${oldPrice} <span>₴</span></p>` : ''}\n            </div>\n\n            <div class=\"basket-main__list-amount-box\">\n              <button class=\"basket-main__list-btn js-basket-btn-decrement\">\n                <svg\n                  class=\"basket-main__list-btn-icon\"\n                  width=\"9\"\n                  height=\"4\">\n                  <use xlink:href=\"#small-arrow-left\"></use>\n                </svg>\n              </button>\n              <span class=\"basket-main__list-amount js-basket-amount\">1</span>\n              <button class=\"basket-main__list-btn js-basket-btn-increment\">\n                <svg\n                  class=\"basket-main__list-btn-icon\"\n                  width=\"9\"\n                  height=\"4\">\n                  <use xlink:href=\"#small-arrow-righ\"></use>\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          <div class=\"basket-main__list-price-box list-price\">\n            <div class=\"list-price__icon-box\">\n              <svg\n                width=\"18\"\n                height=\"18\"\n                class=\"list-price__icon list-price__icon_remove js-remove-card\">\n                <use class=\"js-remove-card\" xlink:href=\"#remove-basket\"></use>\n              </svg>\n              <svg\n                width=\"16\"\n                height=\"14\"\n                class=\"list-price__icon list-price__icon_favorite\">\n                <use xlink:href=\"#icon-heart\"></use>\n              </svg>\n            </div>\n            <p class=\"list-price__price js-current-price\" \n            data-price=\"${price}\">\n            ${price}<span> ₴</span>\n            </p>\n          </div>\n        </li>`;\n  });\n}\n\nexport function markupCardsError() {\n  return `\n      <li\n        class=\"basket-main__list-item_empty-basket list-item__empty-basket js-empty-basket-item\">\n        <h3 class=\"list-item__empty-basket-title\">\n          Ваш кошик порожній - додайте товари, щоб він не сумував.\n        </h3>\n        <img\n          class=\"list-item__empty-basket-img\"\n          width=\"500\"\n          height=\"500\"\n          src=\"https://firebasestorage.googleapis.com/v0/b/flowers-4b1a5.appspot.com/o/pages%2F404%2Fempty-shopping-cart.webp?alt=media&token=3c262b31-1194-4d5e-9cc7-4c1f827f99a0\"\n          alt=\"#\" />\n      </li>`;\n}\n","import { KEY_BASKET } from '../../utils/constants';\nimport { markupCardsSuccess, markupCardsError } from './markup-cards-basket';\nimport { updateLocalStorageCounter } from '../../utils/update-local-storage-counter';\n\nexport function getLocalStorageData() {\n  const cardList = document.querySelector('.js-basket-card-list');\n  const titleShoppingList = document.querySelector('.js-title-shopping-list');\n  const orderTotalPrice = document.querySelector('.js-order-total-price');\n  const goodsPrice = document.querySelector('.js-goods-price');\n  const discount = document.querySelector('.js-discount-price');\n  const btnRemoveAll = document.querySelector('.js-remove-basket-all');\n  // ---refs--\n  let basketArr = JSON.parse(localStorage.getItem(KEY_BASKET)) ?? [];\n\n  // ---createMarkup---\n  function createMarkup(arrData) {\n    if (arrData.length) {\n      cardList.innerHTML = markupCardsSuccess(arrData).join('');\n      titleShoppingList.classList.remove('basket-main__continue-shopping-list_hidden');\n      btnRemoveAll.classList.remove('basket-main__content-remove-all_hidden');\n    } else {\n      cardList.innerHTML = markupCardsError();\n      titleShoppingList.classList.add('basket-main__continue-shopping-list_hidden');\n\n      setTimeout(() => {\n        btnRemoveAll.classList.add('basket-main__content-remove-all_hidden');\n        btnRemoveAll.classList.remove('basket-main__content-remove-all_active');\n      }, 2000);\n    }\n  }\n  createMarkup(basketArr);\n\n  // ---handlerLocalStorageData---\n  cardList.addEventListener('click', handlerLocalStorageData);\n\n  function handlerLocalStorageData({ target, type }) {\n    if (target.classList.contains('js-remove-card')) {\n      removeTargetCard(target);\n    }\n\n    if (target.closest('.js-basket-btn-increment')) {\n      incrementQuantity(target);\n    } else if (target.closest('.js-basket-btn-decrement')) {\n      decrementQuantity(target);\n    }\n  }\n\n  // ------calculateOrde--\n  function calculateOrde(arrData) {\n    let priceWithoutDiscount = 0;\n    let discountPrice = 0;\n\n    arrData.forEach(item => {\n      priceWithoutDiscount += item.oldPrice;\n      discountPrice += item.price;\n    });\n\n    orderTotalPrice.textContent = `${discountPrice} ₴`;\n    goodsPrice.textContent = `${priceWithoutDiscount} ₴`;\n    discount.textContent = `${priceWithoutDiscount - discountPrice} ₴`;\n  }\n\n  calculateOrde(basketArr);\n\n  // ---incrementQuantity---\n  function incrementQuantity(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    let amountEl = targetCard.querySelector('.js-basket-amount');\n    let currentPriceEl = targetCard.querySelector('.js-current-price');\n    let oldPrice = targetCard.querySelector('.js-old-price')\n      ? targetCard.querySelector('.js-old-price').dataset.oldPrice\n      : +currentPriceEl.dataset.price;\n\n    // ---refs--\n    let quantity = +amountEl.textContent;\n    const currentPrice = +currentPriceEl.dataset.price;\n\n    if (quantity >= 10) return;\n\n    amountEl.textContent = quantity += 1;\n    currentPriceEl.textContent = `${currentPrice * quantity} ₴`;\n    goodsPrice.textContent = `${parseInt(goodsPrice.textContent) + Number(oldPrice)} ₴`;\n    orderTotalPrice.textContent = `${parseInt(orderTotalPrice.textContent) + currentPrice} ₴`;\n    discount.textContent = `${parseInt(discount.textContent) + (Number(oldPrice) - currentPrice)} ₴`;\n  }\n\n  // ---decrementQuantity---\n  function decrementQuantity(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    let amountEl = targetCard.querySelector('.js-basket-amount');\n    let currentPriceEl = targetCard.querySelector('.js-current-price');\n    let oldPrice = targetCard.querySelector('.js-old-price')\n      ? targetCard.querySelector('.js-old-price').dataset.oldPrice\n      : +currentPriceEl.dataset.price;\n    // ---refs--\n    let quantity = +amountEl.textContent;\n    const currentPrice = +currentPriceEl.dataset.price;\n\n    if (quantity <= 1) return;\n\n    amountEl.textContent = quantity -= 1;\n    currentPriceEl.textContent = `${currentPrice * quantity} ₴`;\n    goodsPrice.textContent = `${parseInt(goodsPrice.textContent) - Number(oldPrice)} ₴`;\n    orderTotalPrice.textContent = `${parseInt(orderTotalPrice.textContent) - currentPrice} ₴`;\n    discount.textContent = `${parseInt(discount.textContent) - (Number(oldPrice) - currentPrice)} ₴`;\n  }\n\n  // --removeTargetCard---\n  function removeTargetCard(target) {\n    const targetCard = target.closest('.basket-main__list-item');\n    const cardId = targetCard.dataset.id;\n\n    targetCard.remove();\n\n    basketArr = basketArr.filter(({ id }) => {\n      return id !== cardId;\n    });\n\n    localStorage.setItem(KEY_BASKET, JSON.stringify(basketArr));\n\n    updateLocalStorageCounter();\n    calculateOrde(basketArr);\n\n    updateStorage();\n\n    if (!basketArr.length) {\n      cardList.innerHTML = markupCardsError();\n    }\n  }\n\n  // --removeAllCards---\n  btnRemoveAll.addEventListener('click', e => {\n    e.currentTarget.classList.add('basket-main__content-remove-all_active');\n    localStorage.removeItem(KEY_BASKET);\n    basketArr = [];\n    updateLocalStorageCounter();\n    createMarkup(basketArr);\n    orderTotalPrice.textContent = `${0} ₴`;\n    goodsPrice.textContent = `${0} ₴`;\n    discount.textContent = `${0} ₴`;\n  });\n\n  // --updateStorage---\n  window.addEventListener('storage', updateStorage);\n\n  function updateStorage() {\n    basketArr = JSON.parse(localStorage.getItem(KEY_BASKET)) ?? [];\n    updateLocalStorageCounter();\n    createMarkup(basketArr);\n    calculateOrde(basketArr);\n  }\n}\n","import { getFirestore } from 'firebase/firestore';\nimport { getAllDocuments } from '../../utils/mixins';\n\nexport function createMarkupSwiperCard(app) {\n  const recommendationsBox = document.querySelector('.js-basket-recommendations-swiper');\n\n  // ----refs------------\n  const collectionName = ['Recommendations'];\n  const arrContainers = [recommendationsBox];\n  // ---arrs-------------\n\n  const db = getFirestore(app);\n\n  for (let i = 0; i < collectionName.length; i++) {\n    const title = collectionName[i];\n    const container = arrContainers[i];\n\n    getAllDocuments(db, title, container);\n  }\n}\n","import { header } from './partials/header';\nimport { mobMenu } from './partials/mob-menu';\nimport { createAccordionFaq } from './partials/accordion';\nimport { getLocalStorageData } from './pages/basket/get-local-storage-data';\n// import { resizeSwiper } from './utils/mixins';\nimport { updateLocalStorageCounter } from './utils/update-local-storage-counter';\nimport { recommendationsSwiper } from './partials/swiper';\nimport { firebaseConfig } from './partials/firebaseConfig';\nimport { createMarkupSwiperCard } from './pages/basket/create-markup-swiper';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  let app = firebaseConfig();\n  header();\n  mobMenu();\n  createAccordionFaq();\n  getLocalStorageData();\n  updateLocalStorageCounter();\n  recommendationsSwiper();\n  createMarkupSwiperCard(app);\n  // resizeSwiper();\n});\n"],"names":["markupCardsSuccess","arrData","obj","i","id","discount","price","oldPrice","title","png","webp","markupCardsError","getLocalStorageData","cardList","titleShoppingList","orderTotalPrice","goodsPrice","btnRemoveAll","basketArr","KEY_BASKET","createMarkup","handlerLocalStorageData","target","type","removeTargetCard","incrementQuantity","decrementQuantity","calculateOrde","priceWithoutDiscount","discountPrice","item","targetCard","amountEl","currentPriceEl","quantity","currentPrice","cardId","updateLocalStorageCounter","updateStorage","e","createMarkupSwiperCard","app","recommendationsBox","collectionName","arrContainers","db","getFirestore","container","getAllDocuments","firebaseConfig","header","mobMenu","createAccordionFaq","recommendationsSwiper"],"mappings":"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"}